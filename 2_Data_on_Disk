%jdbc CREATE PARTITION FUNCTION PF_DISK (COMPLAINT_ID INTEGER) AS HASH MIN PARTITIONS 5 MAX PARTITIONS 5 USING com.sap.spark.engines

%jdbc CREATE PARTITION SCHEME PS_DISK USING PF_DISK USING com.sap.spark.engines

%jdbc CREATE TABLE COMPLAINTS_DISK 
(DATE_RECEIVED STRING
,SUBMITTED_VIA STRING
,DATE_SENT_TO_COMPANY STRING
,COMPANY_RESPONSE_TO_CONSUMER STRING
,TIMELY_RESPONSE STRING
,CONSUMER_DISPUTED STRING
,COMPLAINT_ID INTEGER )
PARTITION BY PS_DISK(COMPLAINT_ID)
USING com.sap.spark.engines.disk
OPTIONS  (files "/user/vora/complaints.csv", format "csv", csvskip "1")

%jdbc SELECT * FROM COMPLAINTS_DISK LIMIT 2

%jdbc CREATE TABLE FINANCIAL_INS_DISK
(COMPANY STRING
,STATE STRING
,ZIPCODE INTEGER
,COMPLAINT_ID INTEGER)
PARTITION BY PS_DISK(COMPLAINT_ID)
USING com.sap.spark.engines.disk
OPTIONS (files "/user/vora/financialIns.csv", format "csv", csvskip "1")

%jdbc SELECT * FROM FINANCIAL_INS_DISK LIMIT 2

%jdbc SHOW TABLES USING com.sap.spark.engines.disk

